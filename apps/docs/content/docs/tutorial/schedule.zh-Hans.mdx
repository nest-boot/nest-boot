---
title: "定时任务"
description: "基于 Cron 的 NestJS 任务调度，支持装饰器和动态间隔。"
---

`@nest-boot/schedule` 模块基于 [`@nestjs/schedule`](https://docs.nestjs.com/techniques/task-scheduling) 提供 Cron 定时任务调度。

## 安装

```bash
pnpm add @nest-boot/schedule
```

## 模块注册

```typescript
import { ScheduleModule } from "@nest-boot/schedule";

@Global()
@Module({
  imports: [ScheduleModule],
})
export class CommonModule {}
```

## 定义定时任务

使用 `@Cron()` 装饰器定义定时任务：

```typescript
import { Injectable } from "@nestjs/common";
import { Cron, CronExpression } from "@nest-boot/schedule";
import { Logger } from "@nest-boot/logger";

@Injectable()
export class CleanupService {
  constructor(private readonly logger: Logger) {
    this.logger.setContext(CleanupService.name);
  }

  @Cron(CronExpression.EVERY_DAY_AT_MIDNIGHT)
  async cleanupExpiredSessions(): Promise<void> {
    this.logger.log("Cleaning up expired sessions");
    // ...清理逻辑
  }

  @Cron("0 */5 * * * *") // 每 5 分钟
  async syncMetrics(): Promise<void> {
    this.logger.log("Syncing metrics");
    // ...同步逻辑
  }
}
```

## API 参考

详细的 API 文档请参阅[定时任务 API 参考](/docs/api/schedule)。
