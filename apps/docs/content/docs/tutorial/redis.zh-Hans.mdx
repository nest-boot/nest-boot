---
title: "Redis"
description: "NestJS 的 Redis 集成，支持基于环境变量的配置和便捷注入。"
---

`@nest-boot/redis` 模块使用 [ioredis](https://github.com/redis/ioredis) 提供简洁的 Redis 集成，支持基于环境变量的配置。

## 安装

```bash
pnpm add @nest-boot/redis
```

## 模块注册

```typescript
import { RedisModule } from "@nest-boot/redis";

@Global()
@Module({
  imports: [RedisModule],
})
export class CommonModule {}
```

默认读取 `REDIS_URL` 环境变量。

### 自定义配置

```typescript
import { RedisModule } from "@nest-boot/redis";

@Module({
  imports: [
    RedisModule.registerAsync({
      inject: [ConfigService],
      useFactory: (configService: ConfigService) => ({
        url: configService.getOrThrow("REDIS_URL"),
      }),
    }),
  ],
})
export class CommonModule {}
```

## 用法

使用 `@InjectRedis()` 注入 Redis 客户端：

```typescript
import { InjectRedis } from "@nest-boot/redis";
import { Injectable } from "@nestjs/common";
import { Redis } from "ioredis";

@Injectable()
export class CacheService {
  constructor(@InjectRedis() private readonly redis: Redis) {}

  async get(key: string): Promise<string | null> {
    return this.redis.get(key);
  }

  async set(key: string, value: string, ttl?: number): Promise<void> {
    if (ttl) {
      await this.redis.set(key, value, "EX", ttl);
    } else {
      await this.redis.set(key, value);
    }
  }
}
```

## API 参考

详细的 API 文档请参阅 [Redis API 参考](/docs/api/redis)。
