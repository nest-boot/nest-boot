---
title: "Middleware"
description: "Ordered middleware management with dependency resolution for NestJS."
---

The `@nest-boot/middleware` module provides a `MiddlewareManager` that enables dependency-aware, ordered middleware registration — ensuring middleware like auth, RLS, and request transactions execute in the correct order.

## Installation

```bash
pnpm add @nest-boot/middleware
```

## Module Registration

```typescript
import { MiddlewareModule } from "@nest-boot/middleware";

@Global()
@Module({
  imports: [MiddlewareModule],
})
export class CommonModule {}
```

## Usage

`MiddlewareManager` is typically used internally by other `@nest-boot` modules (Auth, AuthRLS, RequestTransaction) to register their middleware with proper ordering. You can also use it directly:

```typescript
import { MiddlewareManager } from "@nest-boot/middleware";
import { Injectable, OnModuleInit } from "@nestjs/common";

@Injectable()
export class MyModule implements OnModuleInit {
  constructor(private readonly middlewareManager: MiddlewareManager) {}

  onModuleInit() {
    this.middlewareManager
      .apply(MyCustomMiddleware)
      .dependencies(AuthMiddleware) // Run after auth
      .forRoutes("*");
  }
}
```

### Key Features

- **Dependency Resolution** — Declare dependencies between middleware to ensure correct execution order
- **Global Excludes** — Exclude routes from all middleware (e.g., auth API routes)
- **Route Scoping** — Apply middleware to specific routes or patterns

## API Reference

For detailed API documentation, see the [Middleware API Reference](/docs/api/middleware).
