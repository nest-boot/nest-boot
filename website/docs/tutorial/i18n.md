---
sidebar_position: 11
---

# I18n

The `@nest-boot/i18n` module provides internationalization (i18n) support via [i18next](https://www.i18next.com/), with file-system-based translation loading and automatic HTTP language detection.

## Installation

```bash
npm install @nest-boot/i18n i18next i18next-fs-backend i18next-http-middleware
# or
pnpm add @nest-boot/i18n i18next i18next-fs-backend i18next-http-middleware
```

## Basic Usage

### Module Registration

Register the `I18nModule` in your application module:

```typescript
import { Module } from "@nestjs/common";
import { I18nModule } from "@nest-boot/i18n";

@Module({
  imports: [
    I18nModule.register({
      fallbackLng: "en",
      supportedLngs: ["en", "zh"],
    }),
  ],
})
export class AppModule {}
```

### Async Registration

```typescript
import { Module } from "@nestjs/common";
import { ConfigModule, ConfigService } from "@nestjs/config";
import { I18nModule } from "@nest-boot/i18n";

@Module({
  imports: [
    ConfigModule.forRoot(),
    I18nModule.registerAsync({
      inject: [ConfigService],
      useFactory: (config: ConfigService) => ({
        fallbackLng: config.get("DEFAULT_LANGUAGE", "en"),
      }),
    }),
  ],
})
export class AppModule {}
```

## Translation Files

By default, translations are loaded from the `locales` directory in your project root:

```
project/
├── locales/
│   ├── en/
│   │   └── translation.json
│   └── zh/
│       └── translation.json
└── src/
```

Example translation file (`locales/en/translation.json`):

```json
{
  "welcome": "Welcome, {{name}}!",
  "errors.notFound": "Resource not found",
  "errors.unauthorized": "You are not authorized"
}
```

## Using Translations

### Using the t() Helper

Use the `t()` utility function to translate strings in your services:

```typescript
import { Injectable } from "@nestjs/common";
import { t } from "@nest-boot/i18n";

@Injectable()
export class GreetingService {
  getWelcomeMessage(name: string): string {
    return t("welcome", { name });
  }

  getErrorMessage(): string {
    return t("errors.notFound");
  }
}
```

### Using the @I18n() Decorator

Inject the i18n instance directly using the `@I18n()` decorator:

```typescript
import { Controller, Get } from "@nestjs/common";
import { I18n as I18nDecorator } from "@nest-boot/i18n";
import { i18n } from "i18next";

@Controller("greetings")
export class GreetingController {
  @Get()
  getGreeting(@I18nDecorator() i18n: i18n) {
    return { message: i18n.t("welcome", { name: "World" }) };
  }
}
```

## Configuration Options

All [i18next options](https://www.i18next.com/overview/configuration-options) are supported, including:

| Option          | Type       | Description                                                   |
| --------------- | ---------- | ------------------------------------------------------------- |
| `fallbackLng`   | `string`   | Fallback language when translation is missing (default: `en`) |
| `supportedLngs` | `string[]` | List of supported languages                                   |
| `ns`            | `string[]` | Namespaces to load                                            |
| `defaultNS`     | `string`   | Default namespace (default: `translation`)                    |
| `keySeparator`  | `string`   | Key separator for nested keys (default: disabled)             |

## Default Configuration

The module provides these defaults:

- **Backend**: File-system backend loading from `locales/{{lng}}/{{ns}}.json`
- **Language Detection**: Automatic via HTTP headers (`Accept-Language`)
- **Fallback Language**: `en`
- **Key Separator**: Disabled (flat key structure)
- **Escape Values**: Disabled (for safe HTML rendering)

## API Reference

See the full [API documentation](/docs/api/@nest-boot/i18n) for detailed information.

## Features

- **i18next Integration** - Full i18next API with NestJS DI
- **File-System Backend** - Automatic loading from JSON translation files
- **HTTP Language Detection** - Auto-detect language from request headers
- **Request-Scoped** - Per-request language via request context
- **Decorator Support** - `@I18n()` parameter decorator for controllers
- **Helper Function** - `t()` utility for quick translations
